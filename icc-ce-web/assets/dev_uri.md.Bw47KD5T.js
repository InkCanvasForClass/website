import{_ as l,C as i,o as s,c as o,j as e,a as n,E as d,am as r}from"./chunks/framework.D5ET_ANy.js";const x=JSON.parse('{"title":"Ink Canvas 外部协议 (URI Scheme) 说明文档","description":"","frontmatter":{},"headers":[],"relativePath":"dev/uri.md","filePath":"dev/uri.md","lastUpdated":1771825844000}'),c={name:"dev/uri.md"};function h(g,t,p,f,u,k){const a=i("ArticleMetadata");return s(),o("div",null,[t[0]||(t[0]=e("h1",{id:"ink-canvas-外部协议-uri-scheme-说明文档",tabindex:"-1"},[n("Ink Canvas 外部协议 (URI Scheme) 说明文档 "),e("a",{class:"header-anchor",href:"#ink-canvas-外部协议-uri-scheme-说明文档","aria-label":'Permalink to "Ink Canvas 外部协议 (URI Scheme) 说明文档"'},"​")],-1)),d(a),t[1]||(t[1]=r('<p>Ink Canvas 支持通过自定义协议 <code>icc://</code> 进行外部调用。通过此功能，其他应用程序、网页脚本或系统快捷方式可以远程控制 Ink Canvas 的运行状态。</p><h2 id="启用方法" tabindex="-1">启用方法 <a class="header-anchor" href="#启用方法" aria-label="Permalink to &quot;启用方法&quot;">​</a></h2><p>在使用外部协议之前，必须先在软件设置中启用：</p><ol><li>打开 <strong>软件设置</strong>。</li><li>进入 <strong>高级选项</strong> 面板。</li><li>找到 <strong>外部协议调用</strong> 区域。</li><li>开启 <strong>“启用外部协议 (icc://)”</strong> 开关。</li></ol><blockquote><p><strong>注意</strong>：此操作会自动在系统注册表中为当前用户注册协议。如果手动关闭该功能，协议将被注销。</p></blockquote><hr><h2 id="命令列表" tabindex="-1">命令列表 <a class="header-anchor" href="#命令列表" aria-label="Permalink to &quot;命令列表&quot;">​</a></h2><h3 id="_1-基础控制命令" tabindex="-1">1. 基础控制命令 <a class="header-anchor" href="#_1-基础控制命令" aria-label="Permalink to &quot;1. 基础控制命令&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">完整 URI</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>Fold</strong></td><td style="text-align:left;"><code>icc://fold</code></td><td style="text-align:left;">进入<strong>收纳模式</strong>。如果当前处于展开状态，将清空墨迹并折叠到侧边栏。</td></tr><tr><td style="text-align:left;"><strong>Unfold</strong></td><td style="text-align:left;"><code>icc://unfold</code></td><td style="text-align:left;">退出<strong>收纳模式</strong>。如果当前已折叠，将展开浮动工具栏。</td></tr><tr><td style="text-align:left;"><strong>Toggle</strong></td><td style="text-align:left;"><code>icc://toggle</code></td><td style="text-align:left;"><strong>切换</strong>状态。已展开则收起，已收起则展开。</td></tr><tr><td style="text-align:left;"><strong>Show</strong></td><td style="text-align:left;"><code>icc://show</code></td><td style="text-align:left;">与 <code>unfold</code> 作用相同，用于兼容旧版指令。</td></tr></tbody></table><h3 id="_2-侧边栏工具命令" tabindex="-1">2. 侧边栏工具命令 <a class="header-anchor" href="#_2-侧边栏工具命令" aria-label="Permalink to &quot;2. 侧边栏工具命令&quot;">​</a></h3><p>以下命令对应收纳模式下侧边栏提供的快速工具。</p><table tabindex="0"><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">完整 URI</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>单次抽</strong></td><td style="text-align:left;"><code>icc://randone</code></td><td style="text-align:left;">打开随机点名窗口并执行<strong>单次抽选</strong>。</td></tr><tr><td style="text-align:left;"><strong>随机抽</strong></td><td style="text-align:left;"><code>icc://rand</code></td><td style="text-align:left;">打开随机点名窗口并执行<strong>随机抽选</strong>。</td></tr><tr><td style="text-align:left;"><strong>计时器</strong></td><td style="text-align:left;"><code>icc://timer</code></td><td style="text-align:left;">打开<strong>计时器/倒计时</strong>工具。</td></tr><tr><td style="text-align:left;"><strong>白板</strong></td><td style="text-align:left;"><code>icc://whiteboard</code></td><td style="text-align:left;">切换到<strong>白板模式</strong>（也可使用 <code>icc://board</code>）。</td></tr></tbody></table><h3 id="_3-工具状态命令" tabindex="-1">3. 工具状态命令 <a class="header-anchor" href="#_3-工具状态命令" aria-label="Permalink to &quot;3. 工具状态命令&quot;">​</a></h3><p>用于切换当前批注工具，或查询当前工具状态。URI 不区分大小写。</p><table tabindex="0"><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">完整 URI</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>笔</strong></td><td style="text-align:left;"><code>icc://tool/pen</code> 或 <code>icc://tool/color</code></td><td style="text-align:left;">切换到<strong>笔</strong>（<code>color</code> 同笔/荧光笔入口）。</td></tr><tr><td style="text-align:left;"><strong>鼠标</strong></td><td style="text-align:left;"><code>icc://tool/cursor</code></td><td style="text-align:left;">切换到<strong>鼠标/光标</strong>模式。</td></tr><tr><td style="text-align:left;"><strong>面积橡皮擦</strong></td><td style="text-align:left;"><code>icc://tool/eraser</code></td><td style="text-align:left;">先进入批注模式，再切换到<strong>面积橡皮擦</strong>。</td></tr><tr><td style="text-align:left;"><strong>笔画橡皮擦</strong></td><td style="text-align:left;"><code>icc://tool/eraserbystrokes</code> 或 <code>icc://tool/eraserstroke</code></td><td style="text-align:left;">先进入批注模式，再切换到<strong>笔画橡皮擦</strong>。</td></tr><tr><td style="text-align:left;"><strong>获取当前工具</strong></td><td style="text-align:left;"><code>icc://tool/state</code></td><td style="text-align:left;">将当前工具状态写入临时文件，供第三方读取。见下方说明。</td></tr></tbody></table><h4 id="icc-tool-state-返回值说明" tabindex="-1"><code>icc://tool/state</code> 返回值说明 <a class="header-anchor" href="#icc-tool-state-返回值说明" aria-label="Permalink to &quot;`icc://tool/state` 返回值说明&quot;">​</a></h4><p>调用后不会在协议层返回内容，而是将当前工具名称写入文件：</p><ul><li><strong>文件路径</strong>：<code>%TEMP%\\InkCanvasToolState.txt</code>（如 <code>C:\\Users\\&lt;用户名&gt;\\AppData\\Local\\Temp\\InkCanvasToolState.txt</code>）</li><li><strong>编码</strong>：UTF-8，单行纯文本。</li></ul><p>可能的值：<code>cursor</code>（鼠标）、<code>pen</code>（笔）、<code>color</code>（荧光笔）、<code>eraser</code>（面积橡皮擦）、<code>eraserByStrokes</code>（笔画橡皮擦）、<code>select</code>（选择）、<code>shape</code>（图形）。默认或无法识别时为 <code>cursor</code>。</p><h3 id="_4-配置方案命令" tabindex="-1">4. 配置方案命令 <a class="header-anchor" href="#_4-配置方案命令" aria-label="Permalink to &quot;4. 配置方案命令&quot;">​</a></h3><p>用于获取当前配置方案列表或通过 URI 切换当前生效的配置方案。URI 不区分大小写。</p><table tabindex="0"><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">完整 URI</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>获取方案列表</strong></td><td style="text-align:left;"><code>icc://config-profile/list</code></td><td style="text-align:left;">将当前所有配置方案名称及当前生效方案写入临时 JSON 文件，供第三方读取。</td></tr><tr><td style="text-align:left;"><strong>切换方案</strong></td><td style="text-align:left;"><code>icc://config-profile/switch?name=方案名</code></td><td style="text-align:left;">切换到指定名称的配置方案并热重载，结果写入临时文件。</td></tr></tbody></table><h4 id="icc-config-profile-list-返回值说明" tabindex="-1"><code>icc://config-profile/list</code> 返回值说明 <a class="header-anchor" href="#icc-config-profile-list-返回值说明" aria-label="Permalink to &quot;`icc://config-profile/list` 返回值说明&quot;">​</a></h4><p>调用后不会在协议层返回内容，而是将列表写入文件：</p><ul><li><strong>文件路径</strong>：<code>%TEMP%\\InkCanvasConfigProfileList.json</code></li><li><strong>编码</strong>：UTF-8，JSON 格式。</li></ul><p>示例内容：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;list&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;方案A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;方案B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;教室1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ],</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;current&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;方案A&quot;</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>list</code>：当前所有已保存的配置方案名称（字符串数组）。</li><li><code>current</code>：当前生效的方案名称；若从未通过方案切换过则为空字符串。</li></ul><h4 id="icc-config-profile-switch-说明" tabindex="-1"><code>icc://config-profile/switch</code> 说明 <a class="header-anchor" href="#icc-config-profile-switch-说明" aria-label="Permalink to &quot;`icc://config-profile/switch` 说明&quot;">​</a></h4><ul><li><strong>查询参数</strong>：<code>name</code>（必填），为要切换到的方案名称。方案名若含中文或特殊字符，需做 URL 编码（如 <code>name=%E6%95%99%E5%AE%A41</code>）。</li><li><strong>结果文件路径</strong>：<code>%TEMP%\\InkCanvasConfigProfileSwitchResult.txt</code></li><li><strong>编码</strong>：UTF-8，单行纯文本。</li><li><strong>可能内容</strong>： <ul><li><code>ok</code>：切换成功，已热重载。</li><li><code>error: 缺少参数 name</code>：未提供 <code>name</code> 参数。</li><li><code>error: 方案不存在或应用失败</code>：指定方案不存在或应用失败。</li></ul></li></ul><p>示例：</p><ul><li>切换到名为“教室1”的方案：<code>icc://config-profile/switch?name=教室1</code></li><li>方案名含特殊字符时使用编码：<code>icc://config-profile/switch?name=%E6%96%B9%E6%A1%88A</code></li></ul><h3 id="_5-进阶功能命令-隐藏功能" tabindex="-1">5. 进阶功能命令（隐藏功能） <a class="header-anchor" href="#_5-进阶功能命令-隐藏功能" aria-label="Permalink to &quot;5. 进阶功能命令（隐藏功能）&quot;">​</a></h3><p>以下功能专门用于解决与第三方侧边栏或悬浮窗程序的兼容性问题，未在常规设置界面显示。URI 不区分大小写，下表为小写形式。</p><table tabindex="0"><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">完整 URI</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>ThoroughHideOn</strong></td><td style="text-align:left;"><code>icc://thoroughhideon</code></td><td style="text-align:left;"><strong>开启</strong>“收起时彻底隐藏”功能。开启后，进入收纳模式时主窗口将完全不可见。</td></tr><tr><td style="text-align:left;"><strong>ThoroughHideOff</strong></td><td style="text-align:left;"><code>icc://thoroughhideoff</code></td><td style="text-align:left;"><strong>关闭</strong>“收起时彻底隐藏”功能。恢复默认的侧边栏边缘留痕模式。</td></tr><tr><td style="text-align:left;"><strong>ThoroughHideToggle</strong></td><td style="text-align:left;"><code>icc://thoroughhidetoggle</code></td><td style="text-align:left;"><strong>切换</strong>“收起时彻底隐藏”功能的开启/关闭状态。</td></tr></tbody></table><hr><h2 id="使用示例" tabindex="-1">使用示例 <a class="header-anchor" href="#使用示例" aria-label="Permalink to &quot;使用示例&quot;">​</a></h2><h3 id="a-在浏览器中调用" tabindex="-1">A. 在浏览器中调用 <a class="header-anchor" href="#a-在浏览器中调用" aria-label="Permalink to &quot;A. 在浏览器中调用&quot;">​</a></h3><p>可以直接在浏览器地址栏输入并回车，或在 HTML 中使用超链接：</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;icc://fold&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;立即收纳 Ink Canvas&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="b-在-windows-运行-对话框中使用" tabindex="-1">B. 在 Windows “运行”对话框中使用 <a class="header-anchor" href="#b-在-windows-运行-对话框中使用" aria-label="Permalink to &quot;B. 在 Windows “运行”对话框中使用&quot;">​</a></h3><p>按下 <code>Win + R</code>，输入 <code>icc://toggle</code> 并回车。</p><h3 id="c-在批处理或命令行中使用" tabindex="-1">C. 在批处理或命令行中使用 <a class="header-anchor" href="#c-在批处理或命令行中使用" aria-label="Permalink to &quot;C. 在批处理或命令行中使用&quot;">​</a></h3><div class="language-cmd vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">start icc://unfold</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="d-第三方读取当前工具状态" tabindex="-1">D. 第三方读取当前工具状态 <a class="header-anchor" href="#d-第三方读取当前工具状态" aria-label="Permalink to &quot;D. 第三方读取当前工具状态&quot;">​</a></h3><p>调用 <code>icc://tool/state</code> 后，读取 <code>%TEMP%\\InkCanvasToolState.txt</code> 即可得到当前工具名称（如 <code>pen</code>、<code>cursor</code>、<code>eraser</code>）。</p><h3 id="e-第三方获取配置方案列表并切换" tabindex="-1">E. 第三方获取配置方案列表并切换 <a class="header-anchor" href="#e-第三方获取配置方案列表并切换" aria-label="Permalink to &quot;E. 第三方获取配置方案列表并切换&quot;">​</a></h3><ol><li>调用 <code>icc://config-profile/list</code> 后，读取 <code>%TEMP%\\InkCanvasConfigProfileList.json</code> 获取 <code>list</code> 与 <code>current</code>。</li><li>调用 <code>icc://config-profile/switch?name=方案名</code> 切换方案，再读取 <code>%TEMP%\\InkCanvasConfigProfileSwitchResult.txt</code> 判断是否成功（内容为 <code>ok</code> 即成功）。</li></ol><hr><h2 id="开发者说明" tabindex="-1">开发者说明 <a class="header-anchor" href="#开发者说明" aria-label="Permalink to &quot;开发者说明&quot;">​</a></h2><h3 id="运行机制" tabindex="-1">运行机制 <a class="header-anchor" href="#运行机制" aria-label="Permalink to &quot;运行机制&quot;">​</a></h3><ol><li><strong>唤醒启动</strong>：如果 Ink Canvas 尚未运行，调用 URI 会直接启动程序并执行命令。</li><li><strong>进程间通信 (IPC)</strong>：如果程序已经在运行，外部调用会通过系统事件和临时文件将指令发送给已运行的实例，实现无缝控制。</li></ol><h3 id="兼容性" tabindex="-1">兼容性 <a class="header-anchor" href="#兼容性" aria-label="Permalink to &quot;兼容性&quot;">​</a></h3><ul><li>支持 Windows 7 及更高版本。</li><li>注册表位置：<code>HKEY_CURRENT_USER\\Software\\Classes\\icc</code>（无需管理员权限）。</li></ul>',54))])}const b=l(c,[["render",h]]);export{x as __pageData,b as default};
